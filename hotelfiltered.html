<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Appending the data</title>
  <style>
    #container {
      width: 90%;
      height: 1200px;
      margin: auto;
      display: flex;
      gap: 30px;
      /* border: 1px solid black; */
    }

    /* #sidebar-one{
    background-color: rgb(135, 120, 120);
    box-shadow: rgba(16, 15, 15, 0.1) 0px 4px 12px;
} */
    #update_div {
      width: 30%;
      /* height: 700px; */
      /* border: 2px solid rgb(13, 159, 17); */
    }

    #product_div {
      width: 68%;
      height: 1000px;
      /* border: 2px solid rgb(197, 12, 12); */
    }

    .u-full-width {
      width: 100%;
      height: 30px;
      margin-top: 10px;
      background-color: rgb(234, 233, 233);
      border: 1px solid rgb(236, 221, 221);
      border-radius: 5px;
      /* display: grid; */
    }

    #update_div button {
      font-weight: 700;
      color: white;
      background-color: rgb(9, 74, 118);
      border-radius: 13px;
    }

    #update_div button:hover {
      cursor: pointer;
      background-color: rgb(131, 180, 226);
      border: 2px solid black;
      transform: scale(1.03);
      font-weight: 1100;
      color: black;
    }

    .card-list {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      padding-left: 10px;
    }

    .card-img img {
      min-width: 349px;
      max-width: 350px;
      min-height: 200px;
      max-height: 200px;

      /* border: 2px solid red; */
    }

    .card-link {
      margin-right: 70px;
      background-color: rgb(15, 56, 223);
      width: 100px;
      height: 30px;
      border-radius: 10px;
      font-weight: 700;
      color: antiquewhite;
    }

    .card-button {
      margin-right: 70px;
      background-color: rgb(255, 69, 18);
      width: 100px;
      height: 30px;
      border-radius: 10px;
      font-weight: 700;
      color: antiquewhite;
    }

    nav {
      display: flex;
      justify-content: space-around;
    }

    #main_perks a {
      text-decoration: none;
      font-size: 30px;
      color: black;
      margin-left: 25px;
    }

    #search {
      width: 200px;
    }
  </style>
</head>

<body>
  <!-- header  -->
  <header>
    <nav>
      <div><img src="./img/Logo.jpeg" alt="image error" id="logo" /></div>
      <div id="search_div">
        <input type="search" id="search" placeholder="Search by name or location" />
      </div>
      <div class="about" id="main_perks">
        <a href="#">About us</a> <a href="#">The Perks</a>
        <a href="#">FAQs</a>
      </div>
      <div><button id="join">Join INR Club</button></div>
    </nav>
  </header>

  <main>
    <h1>
      Admin Page
      <button style="width: 70px"><a href="hotel.html">hotel</a></button>
    </h1>
    <div id="container">
      <!-- update container -->
      <div id="update_div">
        <h2>Update</h2>
        <br />

        <div class="columns four sidebar-one" id="sidebar-one">
          <!-- Add hotels -->
          <div id="filterAdd">
            <h4>Add Hotels</h4>
            <input type="text" id="hotel-name" class="u-full-width" placeholder="Hotel Name" />
            <br />
            <input type="text" id="hotel-image" class="u-full-width" placeholder="Hotel Image Url" />
            <br />
            <input type="text" id="hotel-location" class="u-full-width" placeholder="Location" />
            <br />
            <input type="text" id="hotel-desc" class="u-full-width" placeholder="Description" />
            <br />
            <input type="number" id="hotel-price" class="u-full-width" placeholder="Price" />
            <br />
            <button id="add-hotel" class="u-full-width button button-primary">
              Add Hotel
            </button>
            <hr />
            <br />
          </div>

          <!-- update hotels -->
          <div id="Updatediv">
            <h4>Update all fields of Hotel</h4>
            <input type="text" id="update-hotel-id" class="u-full-width" placeholder="ID" />
            <br />
            <input type="text" id="update-hotel-name" class="u-full-width" placeholder="Hotel Name" />
            <br />
            <input type="text" id="update-hotel-image" class="u-full-width" placeholder="Hotel Image Url" />
            <br />
            <input type="text" id="update-hotel-location" class="u-full-width" placeholder="Location" />
            <br />
            <input type="text" id="update-hotel-desc" class="u-full-width" placeholder="Description" />
            <br />
            <input type="number" id="update-hotel-price" class="u-full-width" placeholder="Price" />
            <br />
            <button id="update-hotel" class="u-full-width button button-primary">
              Update all fields
            </button>
            <hr />
            <br />
          </div>

          <!-- update hotel price -->

          <div id="Updateprice">
            <h4>Update only Price</h4>
            <input type="text" id="update-score-hotel-id" class="u-full-width" placeholder="ID" />
            <br />
            <input type="number" id="update-score-hotel-price" class="u-full-width" placeholder="Price" />
            <br />
            <button id="update-score-hotel" class="u-full-width button button-primary">
              Update Hotel Price
            </button>
            <hr />
            <br />
          </div>

          <!-- sort by price -->

          <div id="Sortdiv">
            <h4>Sort Based On Price</h4>
            <button id="sort-price-low-to-high" class="u-full-width button button-primary">
              Sort Low To High
            </button>
            <br />
            <button id="sort-price-high-to-low" class="u-full-width button button-primary">
              Sort High To Low
            </button>
            <hr />
            <br />
          </div>
          <!-- sort by rating -->
          <div id="SortRating">
            <h4>Sort Based On Rating</h4>
            <button id="sort-rating-low-to-high" class="u-full-width button button-primary">
              Sort Low To High
            </button>
            <br />
            <button id="sort-rating-high-to-low" class="u-full-width button button-primary">
              Sort High To Low
            </button>
            <hr />
          </div>
        </div>
      </div>
      <!-- product div -->
      <div id="product_div">
        <div class="filter_head">
          <h3 id="count">Results</h3>
        </div>

        <div id="product_container">
          <!-- append the product card here -->
        </div>
      </div>
    </div>
  </main>
</body>
<script>
  // ADD Hotels
  let hotelTitleInput = document.getElementById("hotel-name");
  let hotelImageInput = document.getElementById("hotel-image");
  let hotelLocationInput = document.getElementById("hotel-location");
  let hotelDescriptionInput = document.getElementById("hotel-desc");
  let hotelPriceInput = document.getElementById("hotel-price");
  let hotelCreateBtn = document.getElementById("add-hotel");
  // Update Hotels

  let updateHotelIdInput = document.getElementById("update-hotel-id");
  let updateHotelTitleInput = document.getElementById("update-hotel-name");
  let updateHotelImageInput = document.getElementById("update-hotel-image");
  let updateHotelLocationInput = document.getElementById(
    "update-hotel-location"
  );
  let updateHotelDescriptionInput =
    document.getElementById("update-hotel-desc");
  let updateHotelPriceInput = document.getElementById("update-hotel-price");
  let updateHotelBtn = document.getElementById("update-hotel");

  // sorting
  let sortAtoZBtn = document.getElementById("sort-price-low-to-high");
  let sortZtoABtn = document.getElementById("sort-price-high-to-low");

  let sortRatingAtoZBtn = document.getElementById("sort-rating-low-to-high");
  let sortRatingztoABtn = document.getElementById("sort-rating-high-to-low");

  //Update price
  let updatePriceHotelId = document.getElementById("update-score-hotel-id");
  let updatePriceHotelPrice = document.getElementById(
    "update-score-hotel-price"
  );
  let updatePriceHotelPriceButton =
    document.getElementById("update-score-hotel");

  let mainSection = document.getElementById("product_container");

  let count = document.getElementById("count");


  let hotelData = [];



  fetchdata();
  function fetchdata() {
    fetch("https://mock-api-hotels.onrender.com/hotels")
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        console.log(data);
        appendData(data);
        hotelData = data;
      })
      .catch(function (error) {
        console.log(error);
      });
  }

  // appending the data
  function appendData(data) {
    mainSection.innerHTML = "";
    count.textContent = `${data.length} Results`;
    let cardlist = document.createElement("div");
    cardlist.className = "card-list";
    //   cardlist.style.display = "grid";
    //   cardlist.style.gridTemplateColumns = "repeat(3,fr)";
    mainSection.append(cardlist);

    data.forEach(function (item) {
      cardlist.append(cretecard(item));
    });
  }

  // creating card;
  /*
  div card = id=>card;
  card=> img,title(name),location,discription,price,edit,delete

  */

  function cretecard(item) {
    let card = document.createElement("div");
    card.className = "card";
    card.setAttribute("data-id", item.id);

    let cardimg = document.createElement("div");
    cardimg.className = "card-img";

    let img = document.createElement("img");
    img.src = item.image;
    img.setAttribute("alt", "book");
    cardimg.append(img);

    let cardbody = document.createElement("div");
    cardbody.className = "card-body";

    let h4 = document.createElement("h2");
    h4.className = "card-title";
    h4.textContent = item.name;

    let loc = document.createElement("h3");
    loc.className = "location";
    loc.textContent = item.location;

    let p = document.createElement("p");
    p.className = "card-desc";
    p.textContent = item.description;

    let p3 = document.createElement("h3");
    p3.className = "card-price";
    p3.textContent = `$${item.price}`;

    //   let a = document.createElement("button");
    //   a.className = "card-link";
    //   a.setAttribute("data-id", item.id);
    //   a.href = "#";
    //   a.textContent = "Edit";
    //   a.addEventListener("click", function () {
    //     edit(item.id);
    //   });

    let btn = document.createElement("button");
    btn.className = "card-button";
    btn.setAttribute("data-id", item.id);
    btn.textContent = "Delete";
    btn.addEventListener("click", function () {
      let bookId = item.id;
      fetch(`https://mock-api-hotels.onrender.com/hotels/${item.id}`, {
        method: "DELETE",
      })
        .then(function (res) {
          return res.json();
        })
        .then(function (data) {
          location.reload();
          console.log(data);
          appendData(data);
        })
        .catch(function (error) {
          console.log(error);
        });
    });

    cardbody.append(h4, loc, p, p3, btn);

    card.append(cardimg, cardbody);
    return card;
  }

  // Edit function here

  // function edit(id) {}
  updateHotelBtn.addEventListener("click", function (id) {
    fetch(`https://mock-api-hotels.onrender.com/hotels/${id}`, {
      method: "PUT",
      body: JSON.stringify({
        name: updateHotelTitleInput.value,
        location: updateHotelLocationInput.value,
        description: updateHotelDescriptionInput.value,
        image: updateHotelImageInput.value,
        price: updateHotelPriceInput.value,
      }),
      headers: {
        "Content-Type": "application/json",
      },
    })
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        location.reload();

        //   console.log(data);
        appendData(data);
      })
      .catch(function (error) {
        console.log(error);
      });
  });

  // Adding the hotel

  hotelCreateBtn.addEventListener("click", AddHotel);
  function AddHotel() {
    fetch(`https://mock-api-hotels.onrender.com/hotels`, {
      method: "POST",
      body: JSON.stringify({
        name: hotelTitleInput.value,
        location: hotelLocationInput.value,
        description: hotelDescriptionInput.value,
        image: hotelImageInput.value,
        price: hotelPriceInput.value,
      }),
      headers: {
        "Content-type": "application/json",
      },
    })
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        location.reload();

        //   console.log(data);
        appendData(data);
      })
      .catch(function (error) {
        console.log(error);
      });
  }

  // sorting Part

  sortAtoZBtn.addEventListener("click", sort1);
  function sort1() {
    fetch(
      `https://mock-api-hotels.onrender.com/hotels?_sort=price&_order=asc`
    )
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        //   console.log(data);
        appendData(data);
      })
      .catch(function (error) {
        console.log(error);
      });
  }

  sortZtoABtn.addEventListener("click", sort2);
  function sort2() {
    fetch(
      `https://mock-api-hotels.onrender.com/hotels?_sort=price&_order=desc`
    )
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        //   console.log(data);
        appendData(data);
      })
      .catch(function (error) {
        console.log(error);
      });
  }

  sortRatingAtoZBtn.addEventListener("click", sort3);
  function sort3() {
    fetch(
      `https://mock-api-hotels.onrender.com/hotels?_sort=rating&_order=asc`
    )
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        //   console.log(data);
        appendData(data);
      })
      .catch(function (error) {
        console.log(error);
      });
  }

  sortRatingztoABtn.addEventListener("click", sort4);
  function sort4() {
    fetch(
      `https://mock-api-hotels.onrender.com/hotels?_sort=rating&_order=desc`
    )
      .then(function (res) {
        return res.json();
      })
      .then(function (data) {
        //   console.log(data);
        appendData(data);
      })
      .catch(function (error) {
        console.log(error);
      });
  }

  // Search function
  let search = document.querySelector("#search");


  search.addEventListener("input", function () {
    // console.log(hotelData)
    let searchValue = search.value.trim().toLowerCase();

    let results = document.querySelector("#product_container");

    if (searchValue == "") {
      appendData(hotelData);
      count.style.display = "none";
    } else {
      let temp = hotelData.filter(function (el) {
        return el.location.trim().toLowerCase().includes(searchValue);
      });
      count.style.display = "block";
      count.innerText = `${temp.length} Destinations Found`;
      appendData(temp);
    }
  });
</script>

</html>